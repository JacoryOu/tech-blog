<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>深入理解 React 18 的并发特性 - TechBlog</title>
    <link rel="stylesheet" href="css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- 导航栏 -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="index.html" class="nav-logo">
                <span class="logo-icon">&lt;/&gt;</span>
                <span class="logo-text">TechBlog</span>
            </a>
            
            <ul class="nav-menu">
                <li><a href="index.html" class="nav-link">首页</a></li>
                <li><a href="posts.html" class="nav-link">文章</a></li>
                <li><a href="about.html" class="nav-link">关于</a></li>
                <li><a href="contact.html" class="nav-link">联系</a></li>
            </ul>
            
            <div class="nav-actions">
                <button class="theme-toggle" id="themeToggle">
                    <i class="fas fa-moon"></i>
                </button>
                <button class="mobile-menu-toggle" id="mobileMenuToggle">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </div>
    </nav>

    <!-- 文章头部 -->
    <article>
        <header class="article-header">
            <div class="container">
                <div class="article-meta">
                    <div class="post-tags">
                        <span class="tag tag-react">React</span>
                        <span class="tag tag-frontend">前端</span>
                    </div>
                    <span class="read-time"><i class="far fa-clock"></i> 8 分钟阅读</span>
                </div>
                
                <h1 class="article-title">深入理解 React 18 的并发特性</h1>
                
                <div class="post-meta" style="justify-content: flex-start; gap: 2rem;">
                    <div class="author">
                        <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=100&h=100&fit=crop" alt="作者" class="author-avatar">
                        <div>
                            <span class="author-name">张工程师</span>
                            <br>
                            <span style="font-size: 0.875rem; color: var(--text-muted);">前端开发工程师</span>
                        </div>
                    </div>
                    <span class="post-date">2024年1月15日 · 阅读量 1.2k</span>
                </div>
            </div>
        </header>

        <!-- 文章封面 -->
        <div class="container">
            <div class="article-cover">
                <img src="https://images.unsplash.com/photo-1461749280684-dccba630e2f6?w=1200&h=600&fit=crop" alt="React">
            </div>
        </div>

        <!-- 文章内容 -->
        <div class="article-content">
            <p>
                React 18 的发布标志着前端开发进入了一个新的时代。其中最引人注目的特性就是<strong>并发渲染</strong>（Concurrent Rendering），
                它彻底改变了 React 处理更新的方式，让应用能够更好地响应用户交互。
            </p>

            <h2>什么是并发渲染？</h2>

            <p>
                在 React 18 之前，所有的更新都是同步的。这意味着一旦开始渲染，React 必须一口气完成，不能中断。
                如果渲染过程耗时较长，用户就会感觉到界面卡顿。
            </p>

            <p>
                并发渲染允许 React 在渲染过程中<strong>暂停、继续、甚至放弃</strong>正在进行的渲染工作。
                这样，React 可以优先处理紧急的更新（如用户输入），而将非紧急的更新（如列表渲染）延后处理。
            </p>

            <blockquote>
                并发渲染不是一项功能，而是一个底层架构的改变。它解锁了 Suspense、Transitions 等新特性。
            </blockquote>

            <h2>核心 API 介绍</h2>

            <h3>1. useTransition</h3>

            <p>
                <code>useTransition</code> 让你能够区分紧急更新和非紧急更新。
                当你有一个可能较慢的状态更新时，可以将其标记为 transition：
            </p>

            <pre><code>import { useTransition, useState } from 'react';

function App() {
  const [isPending, startTransition] = useTransition();
  const [count, setCount] = useState(0);
  const [items, setItems] = useState([]);

  const handleClick = () => {
    // 紧急更新
    setCount(c => c + 1);
    
    // 非紧急更新 - 包裹在 transition 中
    startTransition(() => {
      const newItems = generateLargeList();
      setItems(newItems);
    });
  };

  return (
    <div>
      <button onClick={handleClick}>
        Count: {count}
        {isPending && ' (加载中...)'}
      </button>
      <ItemList items={items} />
    </div>
  );
}
</code></pre>

            <h3>2. useDeferredValue</h3>

            <p>
                <code>useDeferredValue</code> 用于延迟更新某些不那么重要的部分。
                这在搜索过滤等场景中特别有用：
            </p>

            <pre><code>function SearchResults({ query }) {
  // 延迟查询值，优先响应输入
  const deferredQuery = useDeferredValue(query);
  
  return (
    <div>
      <input value={query} onChange={e => setQuery(e.target.value)} />
      <ExpensiveList query={deferredQuery} />
    </div>
  );
}
</code></pre>

            <h2>自动批处理</h2>

            <p>
                React 18 还引入了<strong>自动批处理</strong>（Automatic Batching）。
                这意味着 React 会自动将多个状态更新合并为一次重新渲染，无论这些更新发生在何处。
            </p>

            <pre><code>// 在 React 18 中，这只会触发一次重新渲染
setTimeout(() => {
  setCount(c => c + 1);
  setFlag(f => !f);
  setName('React 18');
}, 1000);
</code></pre>

            <h2>Suspense 的改进</h2>

            <p>
                React 18 对 Suspense 进行了重大改进，现在它真正支持服务端渲染（SSR）和流式传输。
                这让"边下载边渲染"成为可能，显著提升了首屏加载体验。
            </p>

            <pre><code><Suspense fallback={<Spinner />}>
  <Comments />
</Suspense>
<Suspense fallback={<Spinner />}>
  <RelatedPosts />
</Suspense>
</code></pre>

            <h2>升级指南</h2>

            <p>从 React 17 升级到 18 相对简单，主要步骤包括：</p>

            <ol>
                <li>升级 React 和相关依赖到最新版本</li>
                <li>更新根节点渲染方式（使用 <code>createRoot</code>）</li>
                <li>检查并修复潜在的类型问题</li>
                <li>测试应用的各个功能模块</li>
            </ol>

            <pre><code>// React 17
ReactDOM.render(<App />, document.getElementById('root'));

// React 18
import { createRoot } from 'react-dom/client';
const root = createRoot(document.getElementById('root'));
root.render(<App />);
</code></pre>

            <h2>总结</h2>

            <p>
                React 18 的并发特性为构建高性能应用提供了强大的基础。虽然这些新概念需要一定的学习成本，
                但它们带来的用户体验提升是值得的。建议从 <code>useTransition</code> 和 <code>useDeferredValue</code> 
                开始，逐步掌握并发渲染的精髓。
            </p>

            <p>
                随着这些特性的普及，我们可以期待更多基于并发渲染的创新应用出现。
                现在就开始在你的项目中尝试 React 18 吧！
            </p>
        </div>
    </article>

    <!-- 文章底部 -->
    <section style="background: var(--bg-secondary); padding: 3rem 0;">
        <div class="container">
            <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem;">
                <div>
                    <h3>喜欢这篇文章？</h3>
                    <p style="color: var(--text-secondary);">分享给更多开发者</p>
                </div>
                
                <div style="display: flex; gap: 1rem;">
                    <button class="btn btn-secondary">
                        <i class="fab fa-twitter"></i>
                        <span>Twitter</span>
                    </button>
                    <button class="btn btn-secondary">
                        <i class="fab fa-weixin"></i>
                        <span>微信</span>
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- 相关文章 -->
    <section class="featured-section">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">相关文章</h2>
            </div>
            
            <div class="featured-grid" style="grid-template-columns: repeat(2, 1fr);">
                <article class="post-card">
                    <div class="post-content">
                        <div class="post-tags">
                            <span class="tag tag-react">React</span>
                        </div>
                        <h3 class="post-title">
                            <a href="post.html">React Hooks 最佳实践</a>
                        </h3>
                        <p class="post-excerpt">深入探讨 React Hooks 的使用技巧和常见陷阱...</p>
                    </div>
                </article>

                <article class="post-card">
                    <div class="post-content">
                        <div class="post-tags">
                            <span class="tag tag-frontend">前端</span>
                        </div>
                        <h3 class="post-title">
                            <a href="post.html">前端性能优化指南</a>
                        </h3>
                        <p class="post-excerpt">从加载到渲染，全面提升 Web 应用性能...</p>
                    </div>
                </article>
            </div>
        </div>
    </section>

    <!-- 页脚 -->
    <footer class="footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-brand">
                    <a href="index.html" class="footer-logo">
                        <span class="logo-icon">&lt;/&gt;</span>
                        <span class="logo-text">TechBlog</span>
                    </a>
                    <p class="footer-description">
                        记录技术成长的每一步，分享编程的乐趣与思考。
                    </p>
                    <div class="social-links">
                        <a href="#" class="social-link"><i class="fab fa-github"></i></a>
                        <a href="#" class="social-link"><i class="fab fa-twitter"></i></a>
                        <a href="#" class="social-link"><i class="fab fa-linkedin"></i></a>
                        <a href="#" class="social-link"><i class="fas fa-rss"></i></a>
                    </div>
                </div>
                
                <div class="footer-links">
                    <h4>快速链接</h4>
                    <ul>
                        <li><a href="index.html">首页</a></li>
                        <li><a href="posts.html">文章</a></li>
                        <li><a href="about.html">关于</a></li>
                        <li><a href="contact.html">联系</a></li>
                    </ul>
                </div>
                
                <div class="footer-links">
                    <h4>技术标签</h4>
                    <ul>
                        <li><a href="#">React</a></li>
                        <li><a href="#">TypeScript</a></li>
                        <li><a href="#">Node.js</a></li>
                        <li><a href="#">云原生</a></li>
                    </ul>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2024 TechBlog. All rights reserved.</p>
                <p>Made with <i class="fas fa-heart"></i> and lots of <i class="fas fa-coffee"></i></p>
            </div>
        </div>
    </footer>

    <script src="js/main.js"></script>
</body>
</html>

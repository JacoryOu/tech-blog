#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
AIæ•™ç¨‹åšå®¢æ–‡ç« è‡ªåŠ¨ç”Ÿæˆå™¨ - å®Œæ•´è¯¦ç»†ç‰ˆ
æ¯å¤©ç”Ÿæˆä¸€ç¯‡å®Œæ•´çš„AIæ•™ç¨‹æ–‡ç« 
"""

import os
import json
from datetime import datetime, timedelta

# è¯¦ç»†æ•™ç¨‹ä¸»é¢˜åº“
TUTORIAL_TOPICS = [
    {
        "title": "AIæ™ºèƒ½ä½“å…¥é—¨ï¼šä»æ¦‚å¿µåˆ°å®è·µ",
        "category": "AI",
        "tags": ["AI Agents", "OpenClaw", "å…¥é—¨", "æ•™ç¨‹"],
        "excerpt": "æ·±å…¥ç†è§£AIæ™ºèƒ½ä½“çš„æ ¸å¿ƒæ¦‚å¿µã€å·¥ä½œåŸç†å’Œæ¶æ„è®¾è®¡ï¼Œé€šè¿‡å®Œæ•´çš„å¤©æ°”æŸ¥è¯¢åŠ©æ‰‹æ¡ˆä¾‹ï¼Œå­¦ä¹ å¦‚ä½•ä½¿ç”¨Pythonæ„å»ºä½ çš„ç¬¬ä¸€ä¸ªAIæ™ºèƒ½ä½“ã€‚",
        "sections": ["ä»€ä¹ˆæ˜¯AIæ™ºèƒ½ä½“", "ä¸ºä»€ä¹ˆéœ€è¦AIæ™ºèƒ½ä½“", "AIæ™ºèƒ½ä½“çš„æ ¸å¿ƒæ¶æ„", "ç¯å¢ƒå‡†å¤‡", "å®æ“æ¡ˆä¾‹ï¼šå¤©æ°”æŸ¥è¯¢åŠ©æ‰‹", "è¿›é˜¶åŠŸèƒ½ï¼šè®°å¿†ç³»ç»Ÿ", "æ€»ç»“ä¸å±•æœ›"]
    },
    {
        "title": "RAGå…¥é—¨ï¼šè®©å¤§æ¨¡å‹æ‹¥æœ‰å¤–éƒ¨çŸ¥è¯†",
        "category": "AI",
        "tags": ["RAG", "LLM", "å‘é‡æ•°æ®åº“", "LangChain"],
        "excerpt": "è¯¦è§£æ£€ç´¢å¢å¼ºç”Ÿæˆ(RAG)æŠ€æœ¯åŸç†ã€ç³»ç»Ÿæ¶æ„å’Œå®Œæ•´å®ç°ï¼Œé€šè¿‡ä¼ä¸šçŸ¥è¯†åº“é—®ç­”æ¡ˆä¾‹ï¼Œå­¦ä¹ å¦‚ä½•è®©å¤§è¯­è¨€æ¨¡å‹è®¿é—®å’Œåˆ©ç”¨å¤–éƒ¨çŸ¥è¯†ã€‚",
        "sections": ["ä»€ä¹ˆæ˜¯RAG", "ä¸ºä»€ä¹ˆéœ€è¦RAG", "RAGå·¥ä½œåŸç†", "ç³»ç»Ÿæ¶æ„è®¾è®¡", "ç¯å¢ƒå‡†å¤‡", "å®æ“æ¡ˆä¾‹ï¼šä¼ä¸šçŸ¥è¯†åº“é—®ç­”", "ä¼˜åŒ–æŠ€å·§", "æ€»ç»“"]
    },
    {
        "title": "n8nå…¥é—¨ï¼šé›¶ä»£ç æ„å»ºAIè‡ªåŠ¨åŒ–å·¥ä½œæµ",
        "category": "å·¥å…·",
        "tags": ["n8n", "è‡ªåŠ¨åŒ–", "å·¥ä½œæµ", "NoCode"],
        "excerpt": "å­¦ä¹ ä½¿ç”¨n8nå¯è§†åŒ–å·¥ä½œæµå·¥å…·ï¼Œæ— éœ€ç¼–ç¨‹å³å¯è¿æ¥AI APIå’Œå„ç±»æœåŠ¡ï¼Œé€šè¿‡RSS+AIæ‘˜è¦è‡ªåŠ¨åŒ–æ¡ˆä¾‹æŒæ¡n8næ ¸å¿ƒç”¨æ³•ã€‚",
        "sections": ["ä»€ä¹ˆæ˜¯n8n", "n8nçš„æ ¸å¿ƒä¼˜åŠ¿", "å®‰è£…éƒ¨ç½²", "åŸºç¡€æ¦‚å¿µï¼šèŠ‚ç‚¹ä¸å·¥ä½œæµ", "å®æ“æ¡ˆä¾‹ï¼šRSS+AIæ‘˜è¦è‡ªåŠ¨åŒ–", "è¿›é˜¶æŠ€å·§ï¼šæ¡ä»¶åˆ†æ”¯ä¸é”™è¯¯å¤„ç†", "æœ€ä½³å®è·µ", "æ€»ç»“"]
    },
    {
        "title": "æ™ºèƒ½ä½“è®°å¿†ç®¡ç†ï¼šä»çŸ­æœŸåˆ°é•¿æœŸ",
        "category": "AI",
        "tags": ["AI Agents", "Memory", "æ¶æ„è®¾è®¡"],
        "excerpt": "æ¢ç´¢AIæ™ºèƒ½ä½“çš„è®°å¿†æœºåˆ¶ï¼Œå­¦ä¹ å¦‚ä½•å®ç°çŸ­æœŸä¸Šä¸‹æ–‡è®°å¿†å’Œé•¿æœŸçŸ¥è¯†å­˜å‚¨ï¼Œæ„å»ºå…·å¤‡æŒç»­å­¦ä¹ èƒ½åŠ›çš„æ™ºèƒ½ä½“ã€‚",
        "sections": ["ä¸ºä»€ä¹ˆéœ€è¦è®°å¿†", "è®°å¿†ç±»å‹ï¼šçŸ­æœŸvsé•¿æœŸ", "çŸ­æœŸè®°å¿†å®ç°", "é•¿æœŸè®°å¿†ï¼šæ•°æ®åº“å­˜å‚¨", "è®°å¿†å‹ç¼©ç­–ç•¥", "å®æ“æ¡ˆä¾‹ï¼šä¸ªäººåŠ©ç†è®°å¿†ç³»ç»Ÿ", "éšç§ä¿æŠ¤", "æ€»ç»“"]
    },
    {
        "title": "å‘é‡æ•°æ®åº“é€‰å‹ä¸å®æˆ˜",
        "category": "AI",
        "tags": ["RAG", "å‘é‡æ•°æ®åº“", "é€‰å‹æŒ‡å—"],
        "excerpt": "å¯¹æ¯”Chromaã€Pineconeã€Milvusç­‰ä¸»æµå‘é‡æ•°æ®åº“ï¼Œé€šè¿‡å®é™…æ¡ˆä¾‹å­¦ä¹ å¦‚ä½•é€‰æ‹©å’Œä¼˜åŒ–å‘é‡å­˜å‚¨æ–¹æ¡ˆã€‚",
        "sections": ["ä»€ä¹ˆæ˜¯å‘é‡æ•°æ®åº“", "ä¸»æµæ–¹æ¡ˆå¯¹æ¯”", "Chromaå¿«é€Ÿå…¥é—¨", "Pineconeäº‘æœåŠ¡", "Milvusä¼ä¸šçº§éƒ¨ç½²", "é€‰å‹å»ºè®®", "æ€§èƒ½ä¼˜åŒ–", "æ€»ç»“"]
    },
    {
        "title": "n8nè¿›é˜¶ï¼šå¤æ‚å·¥ä½œæµè®¾è®¡",
        "category": "å·¥å…·",
        "tags": ["n8n", "å·¥ä½œæµ", "è¿›é˜¶"],
        "excerpt": "æŒæ¡n8né«˜çº§åŠŸèƒ½ï¼Œå­¦ä¹ æ¡ä»¶åˆ†æ”¯è®¾è®¡ã€é”™è¯¯å¤„ç†ã€æ•°æ®è½¬æ¢å’Œç›‘æ§å‘Šè­¦ï¼Œæ„å»ºç”Ÿäº§çº§è‡ªåŠ¨åŒ–å·¥ä½œæµã€‚",
        "sections": ["æ¡ä»¶åˆ†æ”¯è®¾è®¡", "é”™è¯¯å¤„ç†æœºåˆ¶", "æ•°æ®è½¬æ¢æŠ€å·§", "å¾ªç¯ä¸æ‰¹å¤„ç†", "å·¥ä½œæµç›‘æ§", "å®æ“æ¡ˆä¾‹ï¼šå†…å®¹å®¡æ ¸ç³»ç»Ÿ", "æ€§èƒ½ä¼˜åŒ–", "æ€»ç»“"]
    }
]

# å®Œæ•´çš„n8næ•™ç¨‹å†…å®¹
N8N_DETAILED_CONTENT = '''### 1. ä»€ä¹ˆæ˜¯n8n

**n8n** æ˜¯ä¸€æ¬¾å¼€æºçš„è‡ªåŠ¨åŒ–å·¥ä½œæµå·¥å…·ï¼Œé‡‡ç”¨å¯è§†åŒ–æ‹–æ‹½æ–¹å¼è®©ç”¨æˆ·æ— éœ€ç¼–ç¨‹å³å¯åˆ›å»ºå¤æ‚çš„è‡ªåŠ¨åŒ–æµç¨‹ã€‚n8n çš„åç§°æ¥æºäº "nodemation"ï¼ˆèŠ‚ç‚¹è‡ªåŠ¨åŒ–ï¼‰ï¼Œæ ¸å¿ƒç†å¿µæ˜¯é€šè¿‡è¿æ¥å„ç§"èŠ‚ç‚¹"æ¥æ„å»ºå·¥ä½œæµã€‚

ä¸ Zapierã€Make(åŸIntegromat) ç­‰å•†ä¸šè‡ªåŠ¨åŒ–å·¥å…·ç›¸æ¯”ï¼Œn8n å…·æœ‰ä»¥ä¸‹ç‹¬ç‰¹ä¼˜åŠ¿ï¼š

- **å®Œå…¨å¼€æº**ï¼šåŸºäº Fair-code åè®®ï¼Œå¯è‡ªæ‰˜ç®¡
- **æ— éœ€ç¼–ç¨‹**ï¼šå¯è§†åŒ–ç•Œé¢ï¼Œæ‹–æ‹½å¼æ“ä½œ
- **400+é›†æˆ**ï¼šæ”¯æŒç»å¤§å¤šæ•°ä¸»æµSaaSæœåŠ¡
- **è‡ªæ‰˜ç®¡é€‰é¡¹**ï¼šæ•°æ®å®Œå…¨æŒæ¡åœ¨è‡ªå·±æ‰‹ä¸­
- **å…è´¹ä½¿ç”¨**ï¼šç¤¾åŒºç‰ˆå®Œå…¨å…è´¹

n8n åœ¨ 2019 å¹´å‘å¸ƒï¼Œç›®å‰å·²è·å¾—è¶…è¿‡ 30k GitHub Starsï¼Œè¢«æ•°åƒå®¶ä¼ä¸šç”¨äºç”Ÿäº§ç¯å¢ƒçš„è‡ªåŠ¨åŒ–å·¥ä½œæµã€‚

### 2. n8nçš„æ ¸å¿ƒä¼˜åŠ¿

#### 2.1 å¯è§†åŒ–å·¥ä½œæµè®¾è®¡

n8n é‡‡ç”¨èŠ‚ç‚¹-è¿çº¿çš„æ–¹å¼è®¾è®¡å·¥ä½œæµï¼Œå°±åƒç”»æµç¨‹å›¾ä¸€æ ·ç›´è§‚ã€‚æ¯ä¸ªèŠ‚ç‚¹ä»£è¡¨ä¸€ä¸ªæ“ä½œï¼ˆå¦‚å‘é€é‚®ä»¶ã€è°ƒç”¨APIã€å¤„ç†æ•°æ®ï¼‰ï¼ŒèŠ‚ç‚¹ä¹‹é—´çš„è¿çº¿è¡¨ç¤ºæ•°æ®æµå‘ã€‚

#### 2.2 ä¸°å¯Œçš„èŠ‚ç‚¹åº“

n8n å†…ç½® 400+ å®˜æ–¹èŠ‚ç‚¹ï¼Œæ¶µç›–ï¼š
- **AI/LLM**ï¼šOpenAIã€Anthropicã€Google AI
- **é€šè®¯**ï¼šSlackã€Discordã€Telegramã€é‚®ä»¶
- **æ•°æ®åº“**ï¼šMySQLã€PostgreSQLã€MongoDBã€Redis
- **äº‘æœåŠ¡**ï¼šAWSã€Azureã€GCP
- **SaaS**ï¼šNotionã€Airtableã€HubSpotã€Salesforce
- **ç¤¾äº¤åª’ä½“**ï¼šTwitterã€LinkedInã€YouTube
- **å¼€å‘å·¥å…·**ï¼šGitHubã€GitLabã€Jira

#### 2.3 è‡ªæ‰˜ç®¡èƒ½åŠ›

```bash
# ä½¿ç”¨ Docker ä¸€é”®å¯åŠ¨
docker run -it --rm \
  --name n8n \
  -p 5678:5678 \
  -v ~/.n8n:/home/node/.n8n \
  n8nio/n8n
```

è‡ªæ‰˜ç®¡æ„å‘³ç€ï¼š
- æ•°æ®ä¸å‡ºå¢ƒï¼Œå®Œå…¨ç¬¦åˆåˆè§„è¦æ±‚
- æ— ä½¿ç”¨é™åˆ¶ï¼Œæ— é…é¢é™åˆ¶
- å¯æ·±åº¦å®šåˆ¶å’Œæ‰©å±•

#### 2.4 ä»£ç èŠ‚ç‚¹æ”¯æŒ

å¯¹äºå¤æ‚é€»è¾‘ï¼Œn8n æ”¯æŒ JavaScript/Python ä»£ç èŠ‚ç‚¹ï¼š

```javascript
// åœ¨ Code èŠ‚ç‚¹ä¸­å¤„ç†æ•°æ®
const results = [];
for (const item of items) {
  results.push({
    json: {
      processed: item.json.name.toUpperCase(),
      timestamp: new Date().toISOString()
    }
  });
}
return results;
```

### 3. å®‰è£…éƒ¨ç½²

#### 3.1 Dockeréƒ¨ç½²ï¼ˆæ¨èï¼‰

åˆ›å»º `docker-compose.yml`ï¼š

```yaml
version: "3"
services:
  n8n:
    image: n8nio/n8n
    restart: always
    ports:
      - "5678:5678"
    environment:
      - N8N_BASIC_AUTH_ACTIVE=true
      - N8N_BASIC_AUTH_USER=admin
      - N8N_BASIC_AUTH_PASSWORD=your_password
      - WEBHOOK_URL=https://your-domain.com/
    volumes:
      - ~/.n8n:/home/node/.n8n
```

å¯åŠ¨æœåŠ¡ï¼š
```bash
docker-compose up -d
```

è®¿é—® `http://localhost:5678` å³å¯å¼€å§‹ä½¿ç”¨ã€‚

#### 3.2 ä½¿ç”¨n8n Cloudï¼ˆæ‰˜ç®¡ç‰ˆï¼‰

å¦‚æœä¸æƒ³è‡ªå·±éƒ¨ç½²ï¼Œå¯ä»¥ä½¿ç”¨ n8n Cloudï¼š
1. è®¿é—® https://n8n.io/cloud
2. æ³¨å†Œè´¦å·ï¼ˆ14å¤©å…è´¹è¯•ç”¨ï¼‰
3. ç«‹å³è·å¾—æ‰˜ç®¡çš„ n8n å®ä¾‹

#### 3.3 npmå®‰è£…

```bash
npm install n8n -g
n8n start
```

### 4. åŸºç¡€æ¦‚å¿µï¼šèŠ‚ç‚¹ä¸å·¥ä½œæµ

#### 4.1 èŠ‚ç‚¹ç±»å‹

| ç±»å‹ | åŠŸèƒ½ | ç¤ºä¾‹ |
|------|------|------|
| **Trigger** | è§¦å‘å·¥ä½œæµ | å®šæ—¶è§¦å‘ã€Webhookã€é‚®ä»¶è§¦å‘ |
| **Action** | æ‰§è¡Œæ“ä½œ | å‘é€é‚®ä»¶ã€åˆ›å»ºæ•°æ®åº“è®°å½• |
| **Logic** | æ§åˆ¶æµç¨‹ | IFæ¡ä»¶ã€Switchåˆ†æ”¯ã€Waitç­‰å¾… |
| **Data** | æ•°æ®å¤„ç† | ä»£ç èŠ‚ç‚¹ã€æ•°æ®è½¬æ¢ã€èšåˆ |

#### 4.2 å·¥ä½œæµåŸºç¡€ç»“æ„

ä¸€ä¸ªå…¸å‹çš„å·¥ä½œæµåŒ…å«ï¼š
1. **è§¦å‘å™¨èŠ‚ç‚¹**ï¼šå†³å®šä½•æ—¶å¯åŠ¨å·¥ä½œæµ
2. **åŠ¨ä½œèŠ‚ç‚¹**ï¼šæ‰§è¡Œå…·ä½“æ“ä½œ
3. **é€»è¾‘èŠ‚ç‚¹**ï¼šæ§åˆ¶æµç¨‹èµ°å‘

#### 4.3 è¡¨è¾¾å¼è¯­æ³•

n8n ä½¿ç”¨ `{{ }}` è¯­æ³•å¼•ç”¨æ•°æ®ï¼š

```
{{$json.title}}           # è·å–å½“å‰é¡¹çš„titleå­—æ®µ
{{$node["HTTP Request"].json.data}}  # è·å–ç‰¹å®šèŠ‚ç‚¹çš„è¾“å‡º
{{new Date().toISOString()}}  # JavaScriptè¡¨è¾¾å¼
```

### 5. å®æ“æ¡ˆä¾‹ï¼šRSS+AIæ‘˜è¦è‡ªåŠ¨åŒ–

#### 5.1 åœºæ™¯æè¿°

æˆ‘ä»¬è¦å®ç°ä¸€ä¸ªè‡ªåŠ¨åŒ–æµç¨‹ï¼š
1. å®šæ—¶è·å– TechCrunch çš„æœ€æ–°æ–‡ç« 
2. ä½¿ç”¨ AI ç”Ÿæˆæ–‡ç« æ‘˜è¦
3. å°†æ‘˜è¦å‘é€åˆ° Slack é¢‘é“

#### 5.2 æ­¥éª¤è¯¦è§£

**æ­¥éª¤1ï¼šåˆ›å»ºè§¦å‘å™¨**

æ·»åŠ  **Schedule Trigger** èŠ‚ç‚¹ï¼š
- è®¾ç½®æ¯30åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡
- CRONè¡¨è¾¾å¼ï¼š`* /30 * * * *`

**æ­¥éª¤2ï¼šè·å–RSSæº**

æ·»åŠ  **RSS Read** èŠ‚ç‚¹ï¼š
- URLï¼š`https://techcrunch.com/feed/`
- é™åˆ¶è¿”å›æ¡ç›®æ•°ï¼š5

**æ­¥éª¤3ï¼šç”ŸæˆAIæ‘˜è¦**

æ·»åŠ  **OpenAI** èŠ‚ç‚¹ï¼š
- é€‰æ‹©æ¨¡å‹ï¼šgpt-3.5-turbo
- ç³»ç»Ÿæç¤ºè¯ï¼š
```
ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æ–°é—»æ‘˜è¦åŠ©æ‰‹ã€‚è¯·å°†ä»¥ä¸‹æ–‡ç« æ€»ç»“ä¸º3-5ä¸ªè¦ç‚¹ï¼Œæ¯ä¸ªè¦ç‚¹ä¸è¶…è¿‡20å­—ã€‚
```
- ç”¨æˆ·æç¤ºè¯ï¼š
```
æ ‡é¢˜ï¼š{{$json.title}}
å†…å®¹ï¼š{{$json.content}}
```

**æ­¥éª¤4ï¼šå‘é€Slacké€šçŸ¥**

æ·»åŠ  **Slack** èŠ‚ç‚¹ï¼š
- è®¤è¯æ–¹å¼ï¼šOAuth2ï¼ˆéœ€æå‰é…ç½®ï¼‰
- æ“ä½œï¼šSend Message
- é¢‘é“ï¼š#news-feed
- æ¶ˆæ¯å†…å®¹ï¼š
```
ğŸ“° *{{$json.title}}*

ğŸ“ æ‘˜è¦ï¼š
{{$node["OpenAI"].json.content}}

ğŸ”— é˜…è¯»åŸæ–‡ï¼š{{$json.link}}
```

#### 5.3 å®Œæ•´å·¥ä½œæµç¤ºæ„å›¾

```
[Schedule Trigger] 
        â†“
[RSS Read - TechCrunch]
        â†“
[OpenAI - ç”Ÿæˆæ‘˜è¦]
        â†“
[Slack - å‘é€é€šçŸ¥]
```

#### 5.4 æµ‹è¯•è¿è¡Œ

ç‚¹å‡» "Execute Workflow" æ‰‹åŠ¨è§¦å‘æµ‹è¯•ï¼š
- æ£€æŸ¥æ¯ä¸ªèŠ‚ç‚¹çš„è¾“å…¥è¾“å‡º
- æŸ¥çœ‹ Slack æ˜¯å¦æ”¶åˆ°æ¶ˆæ¯
- è°ƒæ•´æç¤ºè¯ä¼˜åŒ–æ‘˜è¦è´¨é‡

### 6. è¿›é˜¶æŠ€å·§ï¼šæ¡ä»¶åˆ†æ”¯ä¸é”™è¯¯å¤„ç†

#### 6.1 IFæ¡ä»¶åˆ†æ”¯

å‡è®¾æˆ‘ä»¬è¦æ ¹æ®æ–‡ç« å…³é”®è¯è¿‡æ»¤ï¼š

æ·»åŠ  **IF** èŠ‚ç‚¹ï¼š
- æ¡ä»¶ï¼š`{{$json.title.toLowerCase().includes("ai")}}`
- çœŸåˆ†æ”¯ï¼šå‘é€åˆ° #ai-news é¢‘é“
- å‡åˆ†æ”¯ï¼šå‘é€åˆ° #general-news é¢‘é“

#### 6.2 é”™è¯¯å¤„ç†

ä¸ºå…³é”®èŠ‚ç‚¹é…ç½®é”™è¯¯å¤„ç†ï¼š

```
[OpenAI Node] --(on error)--> [Error Handler] --> [Send Alert Email]
          â†“
    (success)
          â†“
    [Slack Node]
```

**Error Handler** é…ç½®ï¼š
- æ•è·é”™è¯¯ä¿¡æ¯
- å‘é€é‚®ä»¶é€šçŸ¥ç®¡ç†å‘˜
- è®°å½•é”™è¯¯æ—¥å¿—åˆ° Google Sheets

#### 6.3 æ•°æ®è½¬æ¢æŠ€å·§

ä½¿ç”¨ **Function** èŠ‚ç‚¹å¤„ç†å¤æ‚æ•°æ®ï¼š

```javascript
// åˆå¹¶å¤šä¸ªæ•°æ®æº
const merged = [];
for (let i = 0; i < items.length; i++) {
  merged.push({
    json: {
      title: items[i].json.title,
      summary: $node["OpenAI"].all()[i].json.content,
      published: items[i].json.pubDate
    }
  });
}
return merged;
```

#### 6.4 å¾ªç¯å¤„ç†

ä½¿ç”¨ **Split In Batches** èŠ‚ç‚¹æ‰¹é‡å¤„ç†ï¼š
- æ‰¹é‡å¤§å°ï¼š10ï¼ˆé¿å…APIé™æµï¼‰
- å»¶è¿Ÿï¼š1000msï¼ˆæ¯æ‰¹é—´éš”1ç§’ï¼‰

### 7. æœ€ä½³å®è·µ

#### 7.1 å·¥ä½œæµç»„ç»‡

- **å‘½åè§„èŒƒ**ï¼šä½¿ç”¨æ¸…æ™°çš„æè¿°æ€§åç§°
- **é¢œè‰²æ ‡è®°**ï¼šç”¨é¢œè‰²åŒºåˆ†ä¸åŒç±»å‹çš„å·¥ä½œæµ
- **æ·»åŠ æ³¨é‡Š**ï¼šåœ¨å¤æ‚èŠ‚ç‚¹æ·»åŠ æ³¨é‡Šè¯´æ˜
- **ç‰ˆæœ¬æ§åˆ¶**ï¼šå®šæœŸå¯¼å‡ºå·¥ä½œæµJSONå¤‡ä»½

#### 7.2 æ€§èƒ½ä¼˜åŒ–

1. **å‡å°‘APIè°ƒç”¨**ï¼šåˆå¹¶å¯æ‰¹é‡å¤„ç†çš„æ“ä½œ
2. **ä½¿ç”¨ç¼“å­˜**ï¼šç¼“å­˜ä¸å¸¸å˜åŒ–çš„æ•°æ®
3. **åˆç†è®¾ç½®è§¦å‘é¢‘ç‡**ï¼šé¿å…è¿‡äºé¢‘ç¹çš„è½®è¯¢
4. **åˆ†æ‰¹å¤„ç†**ï¼šå¤§æ•°æ®é‡ä½¿ç”¨åˆ†æ‰¹èŠ‚ç‚¹

#### 7.3 å®‰å…¨å»ºè®®

1. **å‡­è¯ç®¡ç†**ï¼šä½¿ç”¨ n8n å†…ç½®çš„å‡­è¯å­˜å‚¨ï¼Œä¸è¦ç¡¬ç¼–ç 
2. **è®¿é—®æ§åˆ¶**ï¼šç”Ÿäº§ç¯å¢ƒå¯ç”¨ Basic Auth
3. **Webhookå®‰å…¨**ï¼šä½¿ç”¨éšæœºtokenéªŒè¯è¯·æ±‚æ¥æº
4. **æ•°æ®è„±æ•**ï¼šæ—¥å¿—ä¸­éšè—æ•æ„Ÿä¿¡æ¯

#### 7.4 è°ƒè¯•æŠ€å·§

1. **æ‰§è¡Œæ—¥å¿—**ï¼šæŸ¥çœ‹æ¯ä¸ªèŠ‚ç‚¹çš„æ‰§è¡Œè¯¦æƒ…
2. **æµ‹è¯•æ•°æ®**ï¼šä½¿ç”¨é™æ€æ•°æ®æµ‹è¯•å·¥ä½œæµ
3. **æ–­ç‚¹è°ƒè¯•**ï¼šåœ¨å…³é”®èŠ‚ç‚¹æš‚åœæ£€æŸ¥æ•°æ®
4. **é”™è¯¯é€šçŸ¥**ï¼šé…ç½®é”™è¯¯æ—¶çš„é‚®ä»¶/Slacké€šçŸ¥

### 8. æ€»ç»“

æœ¬ç¯‡æ–‡ç« è¯¦ç»†ä»‹ç»äº† **n8n** è¿™ä¸€å¼ºå¤§çš„å¼€æºè‡ªåŠ¨åŒ–å·¥å…·ï¼Œä»åŸºç¡€æ¦‚å¿µåˆ°å®æˆ˜æ¡ˆä¾‹ï¼Œå¸®åŠ©ä½ å¿«é€Ÿä¸Šæ‰‹æ„å»ºè‡ªåŠ¨åŒ–å·¥ä½œæµã€‚'''

def get_tutorial_for_date(date=None):
    """æ ¹æ®æ—¥æœŸè·å–å½“å¤©çš„æ•™ç¨‹ä¸»é¢˜"""
    if date is None:
        date = datetime.now()
    start_date = datetime(2026, 2, 5)
    day_number = (date - start_date).days
    index = day_number % len(TUTORIAL_TOPICS)
    return TUTORIAL_TOPICS[index]

def get_next_tutorial(date=None):
    """è·å–æ˜å¤©çš„æ•™ç¨‹ä¸»é¢˜"""
    if date is None:
        date = datetime.now()
    next_date = date + timedelta(days=1)
    return get_tutorial_for_date(next_date)

def generate_n8n_full_content():
    """ç”Ÿæˆå®Œæ•´çš„n8næ•™ç¨‹å†…å®¹"""
    return N8N_DETAILED_CONTENT

def generate_blog_post(date=None):
    """ç”Ÿæˆåšå®¢æ–‡ç« """
    if date is None:
        date = datetime.now()
    
    tutorial = get_tutorial_for_date(date)
    next_tutorial = get_next_tutorial(date)
    
    date_str = date.strftime("%Y-%m-%d")
    time_str = date.strftime("%Y-%m-%d %H:%M:%S")
    
    # æ ¹æ®ä¸»é¢˜ç”Ÿæˆå†…å®¹
    title = tutorial["title"]
    if "n8n" in title:
        detailed_content = generate_n8n_full_content()
    else:
        detailed_content = generate_detailed_placeholder(tutorial)
    
    lines = [
        "---",
        f'title: "{tutorial["title"]}"',
        f"date: {time_str}",
        'author: "å°æ¬§Jacory"',
        f'category: "{tutorial["category"]}"',
        f'tags: {json.dumps(tutorial["tags"], ensure_ascii=False)}',
        "readTime: 20",
        'cover: ""',
        f'excerpt: "{tutorial["excerpt"]}"',
        "featured: false",
        "---",
        "",
        "## ç›®å½•",
        ""
    ]
    
    # æ·»åŠ ç›®å½•é“¾æ¥
    for section in tutorial["sections"]:
        anchor = section.lower().replace(" ", "-").replace("ï¼š", "").replace("|", "")
        lines.append(f"- [{section}](#{anchor})")
    
    lines.extend([
        "",
        "## æ­£æ–‡",
        "",
        detailed_content,
        "",
        "---",
        "",
        "*æœ¬æ–‡ç”±AIè‡ªåŠ¨ç”Ÿæˆï¼Œæ¯æ—¥æ›´æ–°AIæŠ€æœ¯æ•™ç¨‹ã€‚å¦‚æœ‰ç–‘é—®æ¬¢è¿ç•™è¨€äº¤æµï¼*"
    ])
    
    content = "\n".join(lines)
    
    # ç”Ÿæˆæ–‡ä»¶å
    title_slug = tutorial["title"].lower().replace(" ", "-").replace(":", "-").replace("|", "-")[:50]
    filename = f"{date_str}-{title_slug}.md"
    
    return {
        "filename": filename,
        "content": content,
        "title": tutorial["title"],
        "excerpt": tutorial["excerpt"],
        "sections": tutorial["sections"],
        "next_title": next_tutorial["title"]
    }

def generate_detailed_placeholder(tutorial):
    """ä¸ºå…¶ä»–ä¸»é¢˜ç”Ÿæˆå ä½å†…å®¹"""
    sections_text = []
    for i, section in enumerate(tutorial["sections"], 1):
        sections_text.append(f"### {i}. {section}")
        sections_text.append("")
        sections_text.append(f"ã€{section}çš„è¯¦ç»†å†…å®¹å°†åœ¨å‘å¸ƒæ—¶ç”Ÿæˆã€‘")
        sections_text.append("")
    return "\n".join(sections_text)

def save_post(post, output_dir="/home/jacory/clawd/projects/tech-blog/content/posts"):
    """ä¿å­˜æ–‡ç« åˆ°æ–‡ä»¶"""
    filepath = os.path.join(output_dir, post["filename"])
    with open(filepath, "w", encoding="utf-8") as f:
        f.write(post["content"])
    return filepath

def main():
    post = generate_blog_post()
    filepath = save_post(post)
    print(f"æ–‡ç« å·²ç”Ÿæˆ: {filepath}")
    print(f"æ ‡é¢˜: {post['title']}")
    print(f"æ˜å¤©é¢„å‘Š: {post['next_title']}")
    return post

if __name__ == "__main__":
    main()
